<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Summarizer</title>
  </head>
  <style>
    .loading {
    display: inline-block;
    vertical-align: middle;
    }

    .loading span {
    display: inline-block;
    width: 4px;
    height: 4px;
    margin-right: 2px;
    border-radius: 50%;
    background-color: #333;
    animation: loading 1s ease-in-out infinite;
    transition: all 0.3s ease-in-out;
    }

    .loading span:nth-child(1) {
    animation-delay: 0s;
    }

    .loading span:nth-child(2) {
    animation-delay: 0.2s;
    }

    .loading span:nth-child(3) {
    animation-delay: 0.4s;
    }

    @keyframes loading {
    0% {
        transform: scale(0.1);
        opacity: 0.7;
    }
    33.33% {
        opacity: 0.3;
    }
    66.66% {
        transform: scale(1);
        opacity: 0.7;
    }
    100% {
        transform: scale(0.1);
        opacity: 0.7;
    }
}

.progress-bar-container {
  position: relative;
  width: 400px;
  height: 20px;
  background-color: #f2f2f2;
  border-radius: 10px;
  text-align:center;
  position:relative;
  overflow: hidden;
  margin: auto;
}

.progress-bar {
  position: absolute;
  height: 100%;
  background-color: #32ff73;
  border-radius: 10px;
  transition: width 1s ease-in-out;
}

.progresstext{
  position:absolute;
  top:50%;
  right:5px;
  transform: translateY(-50%); 
  font: 14px 'Quicksand', sans-serif;
  color: black;
}

</style>
  <body class="font-sans">
    <header class="bg-gray-800 text-white text-center py-4">
      <h1 class="text-3xl">Summarizer</h1>
    </header>
    <main class="container mx-auto">
      <form class="max-w-lg mx-auto mt-8 flex flex-col">
        <label for="input-text" class="text-lg mb-2">Enter URL to Summarize:</label>
        <div class="relative mt-1 rounded-md shadow-sm">
          <input type="url" id="input-text" name="input-text" class="px-4 py-2 rounded-md border-gray-400 border-2 mb-4 block w-full rounded-md border-gray-300 pl-2 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="Enter URL" />
          <div class="absolute inset-y-5 right-0 flex items-center" style="padding-bottom: 1rem;">
             <div class="loading hidden z-10 -ml-10" id="spinner" role="status"><span></span><span></span><span></span></div>
          </div>
       </div>
        <button id="submit-btn" class="bg-gray-800 text-white rounded-md py-2 text-lg hover:bg-gray-700 cursor-pointer">Summarize</button>
      </form>
      <br>
      <div class="progress-bar-container">
        <div class="progress-bar">
          
        </div>
        <span class="progresstext">0%</span>
      </div>      

      <div id="output-summary" class="max-w-lg mx-auto mt-8">
        <div id="output-summary" class="max-w-lg mx-auto mt-8">
          <h2 class="text-2xl mb-2">Summary:</h2>
        <p id="summary-text" class="px-4 py-2 rounded-md border-gray-400 border-2 mb-4"></p>
      </div>
    </main>
  </body>  
  <script src="https://cdn.tailwindcss.com"></script>
  
  <script>
// Get a reference to the form and input elements
const form = document.querySelector('form');
const inputText = document.querySelector('#input-text');

// Add an event listener for when the form is submitted
form.addEventListener('submit', async (event) => {
  event.preventDefault();
  const text = inputText.value.trim();
  const spinner = document.querySelector('.loading');
  spinner.style.display = 'inline-block'; // Show spinner

  const progressBar = document.querySelector('.progress-bar');
  progressBar.style.width = '0%'; // start from 0%

  // Set up a timer to increment the progress bar every few milliseconds
  let progress = 0;
  let max = Math.random() * 0.5 + 72;
  const timerId = setInterval(() => {
    // Increment the progress bar width by a random amount between 0 and 2%
    progress += Math.random() * 5;
    progressBar.style.width = `${Math.min(progress, max)}%`;
    document.getElementsByClassName('progresstext')[0].innerHTML = `${Math.min(progress, max).toFixed(2)}%`;
  }, 300);

  const response = await fetch(`/summarize?url=${encodeURIComponent(text)}`, {
    method: 'GET',
    headers: {
      'Content-Type': 'application/json'
    }
  });

  // Stop the timer and complete the progress bar animation
  clearInterval(timerId);
  progressBar.style.width = '100%';
  document.getElementsByClassName('progresstext')[0].innerHTML = '100%';
  
  spinner.style.display = 'none'; // Hide spinner

  if (response.ok) {
    const data = await response.json();
    const summary = data.summary;
    const summaryText = document.querySelector('#summary-text');
    summaryText.textContent = summary;
  } else {
    console.error('Error fetching summary:', response.statusText);
  }
});


  </script>
</html>